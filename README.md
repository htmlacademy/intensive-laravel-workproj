# intensive-laravel-workproj

## Общая концепция

Сервис предоставляет возможность отслеживать прогресс просмотра сериалов и получения списка не просмотренных серий.
Сериалам можно выставлять оценки, на основании которых формируются рейтинги позволяющие выбрать новые сериалы для просмотра.

### Основные сценарии использования:

- Просмотр списка сезонов и серий выбранного сериала
- Регистрация пользователя
- Составление списка просматриваемых сериалов и списка не просмотренных серий
- Выставление оценки сериалу
- Просмотр рейтинга популярных сериалов, фильтрация по жанрам, поиск по названию
- Комментирование вышедших серий, возможность ответа на комментарии (получение уведомлений при получении ответа на комментарий **?**)

## Технические требования

Проект должен разрабатываться на PHP версии 7.4 или выше
(при использовании версии 8.0 соответствующее ограничение должно быть указано в файле composer.json). // **[?]** К моменту выпуска курса уже выйдет версия 8.1, думаю стоит сделать минимальной версию 8.0
Используемая база данных — MySQL 5.7 и выше.
Разработка верстки и клиентского приложения не требуется. Ожидается только разработка бекенд api приложения.

Все запросы должны сопровождаться отправкой заголовка принимающего json в качестве ответа,
и ответы, как успешные так и об ошибках, должны возвращаться в json формате.

## Описание процессов

### Регистрация пользователя

Регистрация нового пользователя для получения доступа к персональной части сайта.

**Последовательность действий:**

* Отправка post запроса с данными пользователя на endpoint регистрации.
* Валидация полученных полей. Проверка наличия обязательных полей и соответствия заданным правилам.
* Проверка, что указанный email не занят.
* Сохранение данных в БД, или возвращение списка ошибок при их наличии.
* Сохранение аватара в публичное хранилище и указание ссылки на файл в таблице пользователей.
* Авторизация пользователя под зарегистрированной учетной записи
* Отправка уведомления для подтверждения email. (**?**)
// **[?]** Кто должен отправлять письма - api или клиент? Если api - то он должен знать что-то о шаблонах пусть и типовых,
  если клиент то нам нужно на клиент передавать секретные данные (токен подтверждения)

**Правила валидации:**

* Поля email, password, password_confirmation, name - обязательные
* Поле email - должно быть валидным email адресом (валидация средствами фреймворка), не должно использоваться другими пользователями
* Поле password - минимальная длинна 8 символов, должно совпадать с отправленным password_confirmation
* По желанию: проверка уникальности только по подтвержденным email адресам

### Авторизация

* Отправка post запроса с данными пользователя на endpoint авторизации.
* Валидация полученных полей. Проверка наличия обязательных полей и соответствия заданным правилам.
* Проверка, что email подтвержден. (**?**)
* Авторизация пользователя под зарегистрированной учетной записи.

### Выход (logout)

* Отправка post запроса на endpoint выхода пользователя.
* Уничтожение пользовательской сессии

### Запрос сброса пароля

* Отправка post запроса с email пользователя на endpoint запроса сброса пароля.
* Валидация email адреса (существующий подтвержденный адрес)
* Отправка сообщения со ссылкой для сброса пароля

### Изменение пароля

* Отправка post запроса с данными пользователя на endpoint изменения пароля.
* Обновление пароля пользователя

**Проверяемые данные:**

* token - полученный из ссылки в предыдущем сценарии, обязателен.
* email - валидный, обязательный.
* password, password_confirmation - новый пароль, и подтверждение аналогично правилам регистрации

**Примечание:** для реализации методов работы с пользователем авторизация, регистрация и пр -
рекомендуется использовать пакет `laravel/fortify`

### Получение списка сериалов
// сортировка по дате выхода, популярности
// фильтрация по жанру, по имени
// для авторизованного пользователя возвращаем статус просмотра и оценку

### Получение списка жанров
// для фильтрации

### Получение списка эпизодов сериала
// по id сериала
// для авторизованного пользователя возвращаем статус просмотра

### Получение информации об эпизоде
// по id эпизода
// для авторизованного пользователя возвращаем статус просмотра

### Получение списка комментариев эпизода

### Добавление комментария к эпизоду
// id эпизода, id комментария если ответ

### Получение списка просматриваемых сериалов пользователя

### Получение списка эпизодов отслеживаемого сериала не просмотренных пользователем

### Запрос на добавление сериала **[?]**
// для проработки взаимодействия с внешним api и написание адаптера данных из внешнего источника
// обращение на внешний api сервис https://www.tvmaze.com/api указав сериал по id imdb http://api.tvmaze.com/lookup/shows?imdb=tt0944947
// добавление сериала в локальную БД на основании данных полученных по api tvmaze
